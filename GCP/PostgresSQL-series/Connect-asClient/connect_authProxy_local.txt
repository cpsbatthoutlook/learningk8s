

## Create Instance and DB
xx="  --instance=chander-db-instance "
gcloud init

gcloud sql instances create chander-testdb --database-version=POSTGRES_12  --cpu=1 --memory=4GB 
gcloud sql databases create chander-db $xx

## User mgment
# https://cloud.google.com/sql/docs/postgres/create-manage-users#gcloud
xx="  --instance=chander-testdb "
gcloud sql users create user-name $xx  --password=
gcloud sql users set-password postgres $xx --prompt-for-password
gcloud sql users list $xx
gcloud sql users delete $xx


## IAM  >> Permissions are grouped in ROLES, roles are granted to PRINCIPALS {either users or SA }	

##  AuthProxy for Google Cloud CLI, cURL, or PowerShell, 
  https://cloud.google.com/sql/docs/postgres/connect-instance-auth-proxy
gcloud services enable sqladmin.googleapis.com

sudo apt-get update
sudo apt-get install postgresql-client
curl -o cloud-sql-proxy https://storage.googleapis.com/cloud-sql-connectors/cloud-sql-proxy/v2.2.0/cloud-sql-proxy.linux.amd64
chmod +x cloud-sql-proxy
  ## Get the instance connection name: projectID:region:instanceID.

./cloud-sql-proxy INSTANCE_CONNECTION_NAME
psql "host=127.0.0.1 port=5432 sslmode=disable dbname=chander-db  user=postgres"


